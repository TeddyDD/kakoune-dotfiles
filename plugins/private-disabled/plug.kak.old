define-command plug -params 1..2 %{
    evaluate-commands %sh{
		plugdir="/$HOME/.config/kak/src"

		[ -d $plugdir ] || mkdir -p "$plugdir"
		repo=$(basename $1)
		if [ ! -d "$plugdir/$repo" ]; then
			git clone "https://github.com/$1" "$plugdir/$repo"
		fi
		if [ ! -z "$2" ]; then
			# single file
			echo "source $plugdir/$repo/$2.kak"
			exit
		fi
		for f in $(echo $plugdir/$repo/*.kak); do
    		printf "source %s" "$f"
		done
	}
}

define-command source-dir %{
	nop
}

define-command source-git %{ nop }

define-command source-git-dir -params 1..3 %{
	nop
}
